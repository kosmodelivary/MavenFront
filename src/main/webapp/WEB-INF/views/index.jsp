<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>

<script>
	$(function(){
		$("#wrap").attr("class", "main");
	});
</script>


		<!-- contents -->
		<section id="contents">
			<!-- main_banner -->
			<div class="main_banner">
				<div class="swiper-container">
					<ul class="swiper-wrapper">
						<li class="swiper-slide"
							style="background-image: url(files/main/0102_1_1600x400_B.jpg);">
							<div class="inner">
								<a href="javascript:void(0);" class="bannerLink"
									data-link="menu/All.html"> <img class="w_img"
									src="files/main/0102_1_1600x400_P.png"
									alt="0102_1_1600x400_P.png" /> <img class="m_img"
									src="files/main/0102_M_640x440.jpg" alt="0102_M_640x440.jpg" />
								</a>
							</div>
						</li>
						<li class="swiper-slide"
							style="background-image: url(files/main/LTO_1_1600x400_B.jpg);">
							<div class="inner">
								<a href="javascript:void(0);" class="bannerLink"
									data-link="menu/All.html"> <img class="w_img"
									src="files/main/LTO_1_1600x400_P.png"
									alt="LTO_1_1600x400_P.png" /> <img class="m_img"
									src="files/main/LTO_1_640x440.jpg" alt="LTO_1_640x440.jpg" />
								</a>
							</div>
						</li>
						<li class="swiper-slide"
							style="background-image: url(files/main/LTO_2_1600x400_B.jpg);">
							<div class="inner">
								<a href="javascript:void(0);" class="bannerLink"
									data-link="menu/All.html"> <img class="w_img"
									src="files/main/LTO_2_1600x400_p.png"
									alt="LTO_2_1600x400_p.png" /> <img class="m_img"
									src="files/main/LTO_2640x440.jpg" alt="LTO_2640x440.jpg" />
								</a>
							</div>
						</li>
						<li class="swiper-slide"
							style="background-image: url(files/main/LTO1_1600x400_b.jpg);">
							<div class="inner">
								<a href="javascript:void(0);" class="bannerLink"
									data-link="menu/SpecialOffer.html"> <img class="w_img"
									src="files/main/LTO1_1047x400_p.png" alt="LTO1_1047x400_p.png" />
									<img class="m_img" src="files/main/LTO_m_640x440.jpg"
									alt="LTO_m_640x440.jpg" />
								</a>
							</div>
						</li>
						<li class="swiper-slide"
							style="background-image: url(files/main/LTO2_1600x400_b.jpg);">
							<div class="inner">
								<a href="javascript:void(0);" class="bannerLink"
									data-link="menu/SpecialOffer.html"> <img class="w_img"
									src="files/main/LTO2_p.png" alt="LTO2_p.png" /> <img
									class="m_img" src="files/main/LTO_m2_640x440.jpg"
									alt="LTO_m2_640x440.jpg" />
								</a>
							</div>
						</li>
						<li class="swiper-slide"
							style="background-image: url(files/main/main_bn_08_bg.jpg);">
							<div class="inner">
								<a href="javascript:void(0);" class="bannerLink"
									data-link="customer/noticeList.html"> <img class="w_img"
									src="files/main/main_bn_contents_08.png"
									alt="main_bn_contents_08.png" /> <img class="m_img"
									src="files/main/m_main_bn_08.jpg" alt="m_main_bn_08.jpg" />
								</a>
							</div>
						</li>
					</ul>
				</div>
				<div class="navi">
					<button class="btn btn_prev">이전</button>
					<button class="btn btn_next">다음</button>
					<div class="pagination"></div>
				</div>
			</div>

			<div class="inner">
				<div class="main_best">
					<h2 class="main_tit">
						<span>Best Seller</span>
					</h2>
					<ul class="menu_list">
						<li><a class="openDetailPopup" href="#">
								<figure>
									<img
										src="files/product/460x380_%ed%8a%b8%eb%9f%ac%ed%94%8c%ec%bd%b0%ed%8a%b8%eb%a1%9c%eb%a8%b8%ec%89%ac%eb%a3%b8%ed%8c%a91.png"
										alt="트러플 콰트로 머쉬룸팩 1" />
									<figcaption>
										<span class="tit">트러플 콰트로 머쉬룸팩 1</span> <strong>14,900원</strong>
									</figcaption>
								</figure> <i></i>
						</a>
							<div class="list_cont">
								<a class="btn_cart addProduct" data-pcode="7190338" href="#"><span>담기</span></a>
								<a class="btn_view openDetailPopup" data-pcode="7190338"
									href="#"><span>상세보기</span></a>
							</div></li>
						<li><a class="openDetailPopup"
							href="javascript:PageFunction.openDetailPopup(&#39;7190339&#39;)">
								<figure>
									<img
										src="files/product/460x380_%ed%8a%b8%eb%9f%ac%ed%94%8c%ec%bd%b0%ed%8a%b8%eb%a1%9c%eb%a8%b8%ec%89%ac%eb%a3%b8%ed%8c%a92.png"
										alt="트러플 콰트로 머쉬룸팩 2" />
									<figcaption>
										<span class="tit">트러플 콰트로 머쉬룸팩 2</span> <strong>12,900원</strong>
									</figcaption>
								</figure> <i></i>
						</a>
							<div class="list_cont">
								<a class="btn_cart addProduct" data-pcode="7190339" href="#"><span>담기</span></a>
								<a class="btn_view openDetailPopup" data-pcode="7190339"
									href="#"><span>상세보기</span></a>
							</div></li>
						<li><a class="openDetailPopup" href="#">
								<figure>
									<img
										src="files/product/%eb%b6%89%ec%9d%80%eb%8c%80%ea%b2%8c%ec%99%80%ed%8d%bc%ec%84%b8%ed%8a%b8_460x380.png"
										alt="붉은대게와퍼세트" />
									<figcaption>
										<span class="tit">붉은대게와퍼세트</span> <strong>8,400원</strong>
									</figcaption>
								</figure> <i></i>
						</a>
							<div class="list_cont">
								<a class="btn_cart addProduct" data-pcode="7111350" href="#"><span>담기</span></a>
								<a class="btn_view openDetailPopup" data-pcode="7111350"
									href="#"><span>상세보기</span></a>
							</div></li>
						<li><a class="openDetailPopup" href="#">
								<figure>
									<img src="files/product/wb_460x380.png" alt="와사비크랩버거(딜)" />
									<figcaption>
										<span class="tit">와사비크랩버거(딜)</span> <strong>4,900원</strong>
									</figcaption>
								</figure> <i></i>
						</a>
							<div class="list_cont">
								<a class="btn_cart addProduct" data-pcode="1010012" href="#"><span>담기</span></a>
								<a class="btn_view openDetailPopup" data-pcode="1010012"
									href="#"><span>상세보기</span></a>
							</div></li>
					</ul>
				</div>

				<div class="main_info">
					<div class="main_app">
						<p>TASTE IS KING</p>
						<p>
							<strong>SMART APP</strong>
						</p>
						<p class="img">
							<a target="_blank" title="새창열림" href="#"><img
								src="resources/images/main/btn_ios.png" alt="ios 버거킹 앱 다운" /></a>
							<a target="_blank" title="새창열림" href="#"><img
								src="resources/images/main/btn_android.png"
								alt="안드로이드 버거킹 앱 다운" /></a>
						</p>
						<p>
							<span>버거킹 앱 바로받기</span>
						</p>
					</div>
					<div class="main_sns">
						<p>BURGERKING</p>
						<p>
							<strong>SNS</strong>
						</p>
						<p class="img">
							<a href="#" target="_blank" title="새창열림"><img
								src="resources/images/main/btn_twt.png" alt="버거킹 트위터" /></a> <a
								href="#" target="_blank" title="새창열림"><img
								src="resources/images/main/btn_fb.png" alt="버거킹 페이스북" /></a> <a
								href="#" target="_blank" title="새창열림"><img
								src="resources/images/main/btn_ytv.png" alt="버거킹 유튜브" /></a>
						</p>
						<p>
							<span>버거킹 소셜네트워크 바로가기</span>
						</p>
					</div>
					<a href="#" class="main_brand" target="_blank" title="새창열림"> <span>GO
							TO</span> <span><strong>BURGERKING</strong></span> <span class="img">
							<img src="resources/images/main/main_logo.png" alt="버거킹 브랜드사이트" />
					</span> <span><span>브랜드 사이트 바로가기</span></span>
					</a>
					<div class="main_call">
						<p>딜리버리 전화주문</p>
						<p>
							<strong>10:00 – 22:00 연중무휴</strong>
						</p>
						<p class="img">
							<img class="w_img" src="resources/images/main/main_call.png"
								alt="집에서 만나는 버거킹 1599-0505" /> <a href="#" class="m_img"><img
								src="resources/images/main/main_call.png"
								alt="집에서 만나는 버거킹 1599-0505" /></a>
						</p>
					</div>
				</div>
			</div>
			<!-- 자세히 보기 -->
			<div id="popMenuDetail" class="menu_view_wrap">

				<!-- 시작] 기웅 확인, 베스트 셀러 상세보기 팝업 및 담기용 자바스크립트 jquery 부분 아직 안해도됨 180205 -->
				<script type="text/javascript">
					//<![CDATA[
					//popup parameter
					var PopupParam = {};

					//popup function
					var PopupFunction = (function(pf) {

						pf.init = function() {
							PopupParam.freeToppingList = []
						};

						//가격 원단위 변환
						pf.convertWon = function(price) {
							return price.toString().replace(
									/\B(?=(\d{3})+(?!\d))/g, ",")
									+ '원';
						};

						//컨디먼트 추가
						pf.addCondiment = function(el) {
							var opt = $(el).find('option:selected');
							var price = opt.attr('data-price') * 1;
							var part = $(el).attr('title');
							var memo = $('.' + part + '_memo');
							var totPrice = $('.unit_price').attr(
									'data-price') * 1;
							var qty = $('.opt_qty').text() * 1;

							if (opt.val() != "") {
								// 음료와 사이드는 있을 시 삭제 후 추가
								if ((part == "drink" || part == "side")
										&& memo.size() > 0) {
									this.deleteCondiment(memo
											.attr('data-cCode'), memo
											.attr('data-price'));
									totPrice -= memo.attr('data-price');
								}
								// 동일 재료 추가 불가
								else if (memo.andSelf().find(
										'[data-cCode=' + opt.val() + ']')
										.size() > 0) {
									popAlert('같은 재료는 한번만 추가 가능합니다.');
									return;
								}

								var condimentTag = '<span class="'
										+ part
										+ '_memo" data-cCode="'
										+ opt.val()
										+ '" data-price='
										+ price
										+ '>'
										+ opt.text()
										+ '<a href="javascript:PopupFunction.deleteCondiment(\''
										+ opt.val()
										+ '\','
										+ price
										+ ')" class="btn_delete"></a></span>';

								// 0원 재료 추가 시
								if (part == "topping" && price == 0) {
									PopupParam.freeToppingList.push(opt
											.val());

									// 0원 재료 2개이상일 시 올 엑스트라 추가
									if (PopupParam.freeToppingList.length >= 2
											&& $(
													".topping_memo[data-cCode=7111011]")
													.size() == 0
											&& $(
													".topping_memo[data-cCode=7111012]")
													.size() == 0) {
										if ($('select[title=topping]')
												.find(
														'option[value=7111011]').length > 0) {
											condimentTag += '<span class="topping_memo" data-cCode="7111011" data-price="400">올엑스트라 400 (+400)</span>';
											totPrice += 400;
										} else if ($(
												'select[title=topping]')
												.find(
														'option[value=7111012]').length > 0) {
											condimentTag += '<span class="topping_memo" data-cCode="7111012" data-price="300">올엑스트라 300 (+300)</span>';
											totPrice += 300;
										}

										popAlert('0원 재료 중 2개이상 선택 시\n300~400원이 추가 됩니다.');
									}
								}

								$('.topping_options').append(condimentTag);
								$('.unit_price').attr('data-price',
										totPrice + price);
								$('.unit_price').text(
										this.convertWon((totPrice + price)
												* qty));
							}

							$(el).val("");
						};

						//컨디먼트 삭제
						pf.deleteCondiment = function(cCode, price) {
							var totPrice = $('.unit_price').attr(
									'data-price') * 1;
							var qty = $('.opt_qty').text() * 1;
							price = price * 1;

							// 0원 재료 2개 미만일 때 엑스트라 삭제
							if (PopupParam.freeToppingList.indexOf(cCode) > -1) {
								PopupParam.freeToppingList.splice(
										PopupParam.freeToppingList
												.indexOf(cCode), 1);

								if (PopupParam.freeToppingList.length < 2) {
									if ($('.topping_memo[data-ccode=7111011]').length > 0) {
										$(
												'.topping_options span[data-cCode=7111011]')
												.remove();
										totPrice -= 400;
									} else if ($('.topping_memo[data-ccode=7111012]').length > 0) {
										$(
												'.topping_options span[data-cCode=7111012]')
												.remove();
										totPrice -= 300;
									}
								}
							}

							$(
									'.topping_options span[data-ccode='
											+ cCode + ']').remove();
							$('.unit_price').attr('data-price',
									totPrice - price * 1);
							$('.unit_price').text(
									this.convertWon((totPrice - price * 1)
											* qty));
						};

						//제품상세 수량조절
						pf.changeQty = function(flag) {
							var qty = $('.opt_qty').text() * 1;
							var price = $('.unit_price').attr('data-price') * 1;

							if (flag == 'P') { //Plus
								if (price * (qty + 1) > 150000) { //15만원 미만 주문가능
									popAlert("15만원 미만까지 주문 가능합니다.");
								} else {
									$('.opt_qty').text(qty + 1);
									$('.unit_price').text(
											this.convertWon(price
													* (qty + 1)));
								}
							} else { //Minus
								//최소 수량 1
								if (qty > 1) {
									$('.opt_qty').text(qty - 1);
									$('.unit_price').text(
											this.convertWon(price
													* (qty - 1)));
								}
							}
						};

						//제품 담기
						pf.addProduct = function(pCode, qty) {
							if (qty != 1) {
								qty = $('.opt_qty').text();
							}
							var condimentList = $('.topping_options').find(
									'span');
							var cCode = [];

							if (condimentList.size() > 0) {
								for (var i = 0; i < condimentList.size(); i++) {
									cCode.push(condimentList.eq(i).attr(
											'data-cCode'));
								}
								cCode = cCode.join(',');
							} else {
								cCode = null;
							}

							cntt.ajax.post('/cart/addProduct', {
								pCode : pCode,
								cCode : cCode,
								qty : qty
							}, function(response) {
								if (response) {
									popAlert("제품이 담겼습니다.");

									//TODO : 공통스크립트로 빼기??
									$('.menu_close').click(); //메뉴 상세 팝업 닫기
									condimentList.remove(); //컨디먼트 리스트 삭제
									$('html, body').animate({
										scrollTop : 0
									}, 500); //스크롤 상단 이동
									headerFunc.loadHeaderCart('Y'); //장바구니 갱신
								}
							});
						};

						//제품 담은 후 주문
						pf.goOrderProduct = function(pCode, qty) {
							if (qty != 1) {
								qty = $('.opt_qty').text();
							}
							var condimentList = $('.topping_options').find(
									'span');
							var cCode = [];

							if (condimentList.size() > 0) {
								for (var i = 0; i < condimentList.size(); i++) {
									cCode.push(condimentList.eq(i).attr(
											'data-cCode'));
								}
								cCode = cCode.join(',');
							} else {
								cCode = null;
							}

							cntt.ajax
									.post(
											'/cart/addProduct',
											{
												pCode : pCode,
												cCode : cCode,
												qty : qty
											},
											function(response) {
												if (response) {
													popAlert("제품이 담겼습니다.");
													location.href = "menu/SpecialOffer.html";
												}
											});
						};

						return pf;

					}(window.pf || {}));
					//]]>
				</script>
				<!-- 끝] 기웅 베스트 셀러 상세보기 팝업 및 담기용 자바스크립트 jquery 부분 아직 안해도됨 180205 -->
			</div>
			<!-- //자세히 보기 -->
		</section>
		<!-- 시작] 기웅 캐러셀과 캐러셀에 건 링크, 버거 링크에 관련된 jquery 180205 -->
		<!-- //contents -->
		<script type="text/javascript">
			// page parameter
			var PageParam = {};
			// page function
			var PageFunction = (function(pf) {
				// document ready
				pf.init = function() {
					//<![CDATA[  
					// 퍼블리싱 start
					//메인배너
					if ($('.main_banner li').length > 1) {
						$('.main_banner .w_img').css({
							'opacity' : 0
						});
						var mainBanner = $('.main_banner .swiper-container')
								.swiper(
										{
											pagination : '.main_banner .pagination',
											calculateHeight : true,
											autoplay : 5000,
											speed : 600,
											paginationClickable : true,
											loop : true,
											onFirstInit : function() {
												$('.main_banner .w_img')
														.stop().animate({
															'opacity' : 1
														}, 1000);
											},
											onSlideChangeStart : function() {
												$('.main_banner .w_img')
														.stop().css({
															'opacity' : 0
														});
											},
											onSlideChangeEnd : function() {
												$('.main_banner .w_img')
														.stop().animate({
															'opacity' : 1
														}, 1000);
											}
										});
						$('.main_banner .btn_prev').click(function() {
							mainBanner.swipePrev();
						});

						$('.main_banner .btn_next').click(function() {
							mainBanner.swipeNext();
						});

					}
					// 퍼블리싱 end
					//제품 상세보기 팝업
					/* 
					pf.openDetailPopup = function() {
						var pCode = $(this).data('pcode');
						$('#popMenuDetail').getLoad('/menu/getMenuDetail?pCode=' + pCode, function(){
							PopupFunction.init();
							menuOpen();
						});
					}; 
					 */
					pf.openDetailPopup = function(pCode) {
						$('#popMenuDetail').getLoad(
								'/menu/getMenuDetail?pCode=' + pCode,
								function() {
									PopupFunction.init();
									menuOpen();
								});
					};
					// 배너 링크
					pf.bannerLink = function() {
						var bannerLink = $(this).data('link');
						cntt.goPage(bannerLink);
						/*var indexResult = bannerLink.indexOf('http');
						if (indexResult == -1) {
							cntt.goPage(bannerLink);
						} else {
							window.open(bannerLink);							
						}*/
					};
					//]]>
				};
				return pf;
			}(window.pf || {}));
			// 이벤트
			(function() {
				/* 
				// 담기 버튼
				$('.addProduct').click(function(){
					PopupFunction.addProduct($(this).data('pcode'), 1);
				});
				// 상세보기
				$('.openDetailPopup').click(function(){
					PageFunction.openDetailPopup.call(this);
				}); 
				 */
				// 배너 클릭
				$('.main_banner').on('click', '.bannerLink', function() {
					PageFunction.bannerLink.call(this);
				});
			}());
		</script>
